const l=document.querySelectorAll("img");l.forEach(n=>{n.style.width="120px",n.style.height="120px"});$(document).ready(function(){function n(){const a=bowser.getParser(window.navigator.userAgent).parsedResult;a.platform.type=="desktop"?($(".alert-warning").show(),a.os.name=="Linux"&&a.os.version==null?$(".osWarning").html(`
                                Anda sewajibnya mematikan mode <i>desktop</i> di <i>handphone</i> anda dan gunakan perangkat <i>mobile/handphone</i> jika menggunakan distro linux desktop . Jika pesan ini merupakan sebuah kesalahan silakan untuk diabaikan atau hubungi narahubung dibawah. 
                                <br>
                                (Device type: ${a.platform.type}, Operating System: ${a.os.name} ${a.os.version==null?"":a.os.version})
                                `):$(".osWarning").html(`
                                    Anda sewajibnya menggunakan perangkat <i>mobile/handphone</i> untuk pendaftaran. Jika pesan ini merupakan sebuah kesalahan silakan untuk diabaikan atau hubungi narahubung dibawah. 
                                    <br>
                                    (Device type: ${a.platform.type}, Operating System: ${a.os.name} ${a.os.version==null?"":a.os.version})
                                    `)):$(".alert-warning").hide()}n(),window.addEventListener("resize",n);let r=document.querySelectorAll(".form-control");r.forEach(a=>{let e=a.getAttribute("class"),s=a.getAttribute("inputmode")=="numeric";a.addEventListener("blur",()=>{a.validity.valueMissing&&($(`#${a.getAttribute("id")}+.invalid-feedback`).html("Pertanyan wajib dijawab"),a.setAttribute("class",`${e} is-invalid`))}),a.addEventListener("input",()=>{a.setAttribute("class",e),s&&isNaN(a.value)?($(`#${a.getAttribute("id")}+.invalid-feedback`).html("Jawaban wajib berupa angka"),a.setAttribute("class",`${e} is-invalid`)):a.setAttribute("class",e)}),a.addEventListener("invalid",()=>{$(`#${a.getAttribute("id")}+.invalid-feedback`).html("Pertanyan wajib dijawab"),a.setAttribute("class",`${e} is-invalid`),s&&isNaN(a.value)&&($(`#${a.getAttribute("id")}+.invalid-feedback`).html("Jawaban wajib berupa angka"),a.setAttribute("class",`${e} is-invalid`))})});const d=new bootstrap.Modal(document.getElementById("myModal"));$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#next").on("click",function(){setTimeout(function(){$("#info-umum").hide(),$("#myform").show(),$(".displayA").show(),location.href="#"},500)}),$("#prev").on("click",function(){setTimeout(function(){$("#info-umum").show(),$("#myform").hide(),$(".displayA").hide(),location.href="#"},500)}),$("#myform").on("submit",function(a){a.preventDefault(),r.forEach(t=>{let i=t.getAttribute("class"),o=t.getAttribute("inputmode")=="numeric";if(t.validity.valueMissing)throw $(`#${t.getAttribute("id")}+.invalid-feedback`).html("Jawaban wajib dijawab"),t.setAttribute("class",`${i} is-invalid`),t.focus(),t.scrollIntoView({behavior:"smooth",block:"center"}),new Error("Jawaban wajib dijawab");if(o&&isNaN(t.value))throw $(`#${t.getAttribute("id")}+.invalid-feedback`).html("Jawaban wajib berupa angka"),t.setAttribute("class",`${i} is-invalid`),t.focus(),t.scrollIntoView({behavior:"smooth",block:"center"}),new Error("Jawaban wajib berupa angka")}),$(".modal-header").attr("class","modal-header"),$(".daftar").html('Memproses<span class="dots"></span>'),$(".info").html('Memproses<span class="dots"></span>'),d.show(d);let e=3;var s=$(this).serialize();$.ajax({url:"/pendaftaran-habsyi",type:"POST",data:s,timeout:2e4,success:function(t){console.log(t),$(".modal-header").attr("class","modal-header d-flex justify-content-center"),$(".daftar").html('<span class="alert alert-success border-success">PENDAFTARAN BERHASIL!</span>'),$(".info").html('<p>Data anda telah direkam dan terimakasih telah mendaftar di Ektrakurikuler Habsyi Syafatul Musthofa MAN 2 Kota Banjarmasin.</p><div class="font-s">Jangan keluar dari halaman ini karena anda akan diarahkan ke grup WhatsApp dalam <span class="sec">3</span></div>');const i=setInterval(function(){$(".sec").html(e),e--,e<=0&&(location.href=t.direct_link,$("#myform")[0].reset(),$(".register p span").html(`${t.name}`),$(".register").attr("class","alert alert-danger alert-dismissible regsiter d-block"),$(".modalButton").show(),$("#info-umum").show(),$("#myform").hide(),$(".displayA").hide(),location.href="#",clearInterval(i))},885)},error:function(t,i){if($(".modal-header").attr("class","modal-header d-flex justify-content-center"),$(".daftar").html('<span class="alert alert-danger border-danger">PENDAFTARAN GAGAL!</span>'),i==="timeout")$(".info").html(' <div class="font-s text-danger-emphasis fw-bold ">Connection timed out. Silakan klik tombol "Konfirmasi" sekali lagi . </div>'),$(".modalButton").show();else if(t.responseJSON.errorCode==403)$(".info").html(` <div class="font-s text-danger-emphasis fw-bold "> ${t.responseJSON.message}</div>`),$(".modalButton").show();else if(t.responseJSON.errorCode==422){const o=t.responseJSON.message;$(".info").html(""),$.each(o,function(){$(".info").append(` <div class="font-s"> ${this.join("")}</div>`)}),$(".modalButton").show()}else $(".info").html(`<p class="text-danger-emphasis fw-bold font-s">Data anda gagal ditambahkan. (Error Code: ${t.responseJSON.errorCode==null?t.status:t.responseJSON.errorCode}) </p>Mohon maaf atas ketidaknyamananya, kami sangat menyesalkan kejadian ini. Silakan hubungi <a class="text-info-emphasis" href="whatsapp://send?phone=6288247034763&text=Assalamu'alaikum,%20saya%20atas%20nama%20${t.responseJSON.name}%20memiliki%20kendala%20dengan%20pendaftaran%20(Error%20Code:%20${t.responseJSON.errorCode==null?t.status:t.responseJSON.errorCode})(jangan hapus pesan ini)">Admin</a> atau ulangi pendaftaran.`),$(".modalButton").show()}})})});
